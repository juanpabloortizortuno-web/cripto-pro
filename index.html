<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>CDC FUTURO CRIPTO | Dashboard PRO</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root {
  --bg-main: #121212;
  --bg-card: #1e1e28;
  --accent-yellow: #fcd535;
  --accent-blue: #0099ff;
  --accent-green: #4caf50;
  --accent-red: #ff5252;
  --text-light: #e0e0e0;
  --text-muted: #8a8e94;
}

body {
  margin: 0; font-family: 'Segoe UI', Tahoma, sans-serif;
  background: var(--bg-main); color: var(--text-light);
  overflow: hidden;
}

/* Encabezado */
header {
  background: var(--bg-card); padding: 15px;
  border-bottom: 2px solid var(--accent-yellow);
  display: flex; justify-content: center; align-items: center;
  position: sticky; top: 0; z-index: 1000;
}

header h1 { margin: 0; color: var(--accent-yellow); font-size: 20px; }

.menu-btn {
  position: absolute; left: 12px;
  background: var(--accent-yellow); border: none;
  border-radius: 6px; width: 38px; height: 38px;
  font-size: 20px; cursor: pointer; font-weight: bold;
}

#statusBar {
  text-align: center; padding: 8px; background: #252531;
  border-bottom: 2px solid var(--accent-blue);
  font-weight: bold; font-size: 13px;
}

.container { display: flex; height: calc(100vh - 110px); position: relative; }

/* SIDEBAR */
.sidebar {
  width: 350px; background: var(--bg-card);
  border-right: 2px solid var(--accent-yellow);
  display: flex; flex-direction: column;
  transition: transform 0.3s ease; z-index: 900;
}

.sidebar.hidden { transform: translateX(-100%); position: absolute; }

.table-container { overflow-y: auto; flex: 1; }

/* CONTENIDO PRINCIPAL */
.main { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; }

input {
  width: calc(100% - 30px); margin: 10px 15px;
  padding: 12px; border-radius: 8px; border: none;
  background: #2c2c3a; color: white; outline: none;
}

table { width: 100%; border-collapse: collapse; }
th { position: sticky; top: 0; background: var(--accent-yellow); color: #000; padding: 12px; font-size: 13px; z-index: 10; }
td { padding: 12px; text-align: center; border-bottom: 1px solid #333; font-size: 14px; }
tr:hover { background: #2c2c3a; cursor: pointer; }

/* DETALLES */
#details {
  background: #252531; padding: 20px; border-radius: 12px;
  margin-bottom: 20px; border-left: 5px solid var(--accent-yellow);
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}

.detail-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px; }
.detail-item { background: #1a1a24; padding: 10px; border-radius: 8px; }
.detail-item small { color: var(--text-muted); display: block; margin-bottom: 5px; }

/* BOTONES */
.btn-action {
  width: 100%; padding: 15px; border-radius: 10px; border: none;
  font-weight: bold; cursor: pointer; font-size: 16px;
  text-decoration: none; display: block; text-align: center;
  margin-bottom: 10px; transition: 0.3s;
}

.btn-binance { background: var(--accent-blue); color: #fff; }
.btn-whatsapp { background: #25d366; color: #fff; }
.btn-premium { background: var(--accent-yellow); color: #000; }

.section-title { padding: 12px; font-size: 14px; color: var(--accent-blue); font-weight: bold; background: #1a1a24; }
.green { color: var(--accent-green); font-weight: bold; }
.red { color: var(--accent-red); font-weight: bold; }

@media (max-width: 768px) {
  .sidebar { position: absolute; left: 0; top: 0; height: 100%; width: 300px; }
  .sidebar.hidden { transform: translateX(-100%); }
}
</style>
</head>

<body>

<header>
  <button class="menu-btn" id="menuToggle">‚¨Ö</button>
  <h1>üöÄ CDC FUTURO CRIPTO</h1>
</header>

<div id="statusBar">Conectando con Binance Pro...</div>

<div class="container">

  <div class="sidebar" id="sidebar">
    <input id="search" placeholder="üîç Buscar moneda (ej: BTC)">
    <div class="table-container">
      <div class="section-title">üìà FUTUROS (0.08 - 50 USDT)</div>
      <table>
        <thead><tr><th>Moneda</th><th>% M√°x</th><th>Se√±al</th></tr></thead>
        <tbody id="futuresTable"></tbody>
      </table>

      <div class="section-title">‚ú® TOP SPOT</div>
      <table>
        <thead><tr><th>Token</th><th>Precio</th></tr></thead>
        <tbody id="spotTable"></tbody>
      </table>
    </div>
  </div>

  <div class="main" id="mainContent">
    <div id="details">
      <p style="text-align:center;">Selecciona una moneda activa para ver detalles profundos.</p>
    </div>

    <a id="btnOpenBinance" class="btn-action btn-binance" style="display:none;">
      ‚ö° ANALIZAR EN APP BINANCE
    </a>

    <div style="margin-top: auto; border-top: 1px solid #333; padding-top: 20px;">
      <input id="premiumCode" placeholder="üîë Ingresa C√≥digo Licencia">
      <button class="btn-action btn-premium" onclick="activatePremium()">ACTIVAR LICENCIA PRO</button>
    </div>

    <a href="https://wa.me/59177068807" class="btn-action btn-whatsapp" target="_blank">
      üì≤ SOPORTE WHATSAPP
    </a>

    <footer style="text-align:center; font-size:12px; padding:10px;">
        <a href="https://www.tiktok.com/@chicodelascomputadoras" target="_blank" style="color:var(--accent-blue); text-decoration:none; font-weight:bold;">
           TikTok: @chicodelascomputadoras
        </a>
    </footer>
  </div>

</div>

<script>
const menuBtn = document.getElementById("menuToggle");
const sidebar = document.getElementById("sidebar");
const openBtn = document.getElementById("btnOpenBinance");
let currentSymbol = "";
let clickCount = parseInt(localStorage.getItem("clickCount")) || 0;

// Men√∫ retr√°ctil
menuBtn.onclick = () => {
  sidebar.classList.toggle("hidden");
  menuBtn.innerText = sidebar.classList.contains("hidden") ? "‚û°" : "‚¨Ö";
};

// L√≥gica de apertura mejorada con Square para TikTok
function openBinance(symbol) {
  if (!symbol) return;
  // Usamos el enlace de Square que confirmaste para forzar la App
  const url = `https://www.binance.com/es/square/post/16263307959081?symbol=${symbol.toUpperCase()}`;
  window.open(url, "_blank");
}

function updateStatus() {
  const isPremium = localStorage.getItem("premiumActive") === "1";
  const bar = document.getElementById("statusBar");
  if(isPremium) {
    bar.innerText = "‚úÖ LICENCIA PREMIUM ACTIVA";
    bar.style.color = "var(--accent-green)";
  } else {
    bar.innerText = `‚ú≥Ô∏è Clics: ${clickCount} / 10`;
  }
}

// Obtener datos detallados
async function showDetails(c, isSpot = false) {
  if (localStorage.getItem("premiumActive") !== "1" && clickCount >= 10) {
    document.getElementById("details").innerHTML = `<p class="red" style="text-align:center;">L√≠mite alcanzado. Adquiere tu licencia en WhatsApp.</p>`;
    return;
  }
  
  if (localStorage.getItem("premiumActive") !== "1") {
    clickCount++; localStorage.setItem("clickCount", clickCount); updateStatus();
  }

  currentSymbol = c.symbol;
  openBtn.style.display = "block";
  openBtn.onclick = () => openBinance(currentSymbol);

  // Obtener Funding Rate en tiempo real
  let funding = "N/A";
  if(!isSpot) {
    try {
      const fr = await fetch(`https://fapi.binance.com/fapi/v1/premiumIndex?symbol=${c.symbol}`);
      const fj = await r = await fr.json();
      funding = (parseFloat(fj.lastFundingRate) * 100).toFixed(4) + "%";
    } catch(e) { funding = "0.00%"; }
  }

  const volM = (parseFloat(c.volume) / 1000000).toFixed(2);

  document.getElementById("details").innerHTML = `
    <h2 style="margin:0; color:var(--accent-yellow);">${c.symbol}</h2>
    <div class="detail-grid">
      <div class="detail-item"><small>PRECIO ACTUAL</small><b>$${c.price}</b></div>
      <div class="detail-item"><small>CAMBIO 24H</small><b class="${c.change >= 0 ? 'green':'red'}">${c.change}%</b></div>
      <div class="detail-item"><small>VOLUMEN</small><b>$${volM}M</b></div>
      <div class="detail-item"><small>FUNDING</small><b class="blue">${funding}</b></div>
      <div class="detail-item" style="grid-column: span 2;">
        <small>CERCAN√çA AL M√ÅXIMO (SE√ëAL)</small>
        <b class="${c.dist < 20 ? 'green':'red'}">${c.dist.toFixed(2)}% - ${c.dist < 20 ? 'üü¢ COMPRA (LONG)' : 'üî¥ VENTA (SHORT)'}</b>
      </div>
    </div>
  `;
  if (window.innerWidth < 768) sidebar.classList.add("hidden");
}

async function loadData() {
  try {
    // 1. Validar monedas activas en Futuros (Filtra WAVES y delisted)
    const exInfo = await fetch("https://fapi.binance.com/fapi/v1/exchangeInfo");
    const exJ = await exInfo.json();
    const activeFutures = new Set(exJ.symbols.filter(s => s.status === "TRADING").map(s => s.symbol));

    // 2. Obtener precios y estad√≠sticas
    const resp = await fetch("https://api.binance.com/api/v3/ticker/24hr");
    const data = await resp.json();
    const q = document.getElementById("search").value.toUpperCase();

    // Filtro Futuros
    const fTable = document.getElementById("futuresTable");
    fTable.innerHTML = "";
    data.filter(c => activeFutures.has(c.symbol))
      .map(c => {
        const low = +c.lowPrice, high = +c.highPrice, price = +c.lastPrice;
        return { 
          symbol: c.symbol, price, low, high, change: c.priceChangePercent, 
          volume: c.quoteVolume, dist: ((price-low)/(high-low))*100 
        };
      })
      .filter(c => c.price >= 0.08 && c.price <= 50 && (!q || c.symbol.includes(q)))
      .sort((a,b) => b.dist - a.dist)
      .forEach(c => {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td><b>${c.symbol.replace("USDT","")}</b></td><td>${c.dist.toFixed(1)}%</td><td class="${c.dist<20?'green':'red'}">${c.dist<20?'LONG':'SHORT'}</td>`;
        tr.onclick = () => showDetails(c);
        fTable.appendChild(tr);
      });

    // Filtro Spot
    const sTable = document.getElementById("spotTable");
    sTable.innerHTML = "";
    data.filter(c => c.symbol.endsWith("USDT") && !activeFutures.has(c.symbol))
      .filter(c => c.lastPrice >= 0.08 && c.lastPrice <= 50 && (!q || c.symbol.includes(q)))
      .slice(0, 15)
      .forEach(c => {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${c.symbol}</td><td>$${parseFloat(c.lastPrice).toFixed(4)}</td>`;
        tr.onclick = () => showDetails({symbol: c.symbol, price: c.lastPrice, change: c.priceChangePercent, volume: c.quoteVolume, dist: 0}, true);
        sTable.appendChild(tr);
      });

    updateStatus();
  } catch(e) { console.error("Error en API", e); }
}

function activatePremium() {
  if(document.getElementById("premiumCode").value.trim().length > 3) {
    localStorage.setItem("premiumActive", "1");
    alert("¬°Licencia PRO Activada!");
    location.reload();
  }
}

document.getElementById("search").oninput = loadData;
loadData();
setInterval(loadData, 30000);
</script>
</body>
</html>