<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CDC FUTURO-PRO SHORT</title>

<style>
:root {
  --bg-main:#0f1115;
  --bg-card:#1a1d24;
  --yellow:#fcd535;
  --green:#00c853;
  --red:#ff5252;
  --orange:#ff9800;
  --text:#e0e0e0;
}

body{
  margin:0;
  font-family:Segoe UI;
  background:var(--bg-main);
  color:var(--text);
}

header{
  background:var(--bg-card);
  padding:15px;
  text-align:center;
  border-bottom:2px solid var(--yellow);
}

h1{
  margin:0;
  font-size:18px;
  color:var(--yellow);
}

#statusBar{
  text-align:center;
  padding:8px;
  background:#1f222a;
  font-size:12px;
  color:var(--yellow);
}

.container{
  display:flex;
  height:calc(100vh - 100px);
}

.sidebar{
  width:320px;
  background:var(--bg-card);
  overflow-y:auto;
  border-right:2px solid var(--yellow);
}

table{
  width:100%;
  border-collapse:collapse;
}

th{
  background:var(--yellow);
  color:black;
  font-size:11px;
  padding:6px;
}

td{
  padding:10px 6px;
  font-size:12px;
  text-align:center;
  border-bottom:1px solid #333;
}

tr:hover{
  background:#252933;
  cursor:pointer;
}

.main{
  flex:1;
  padding:15px;
  overflow-y:auto;
}

.card{
  background:var(--bg-card);
  padding:20px;
  border-radius:12px;
  box-shadow:0 0 15px rgba(0,0,0,0.4);
}

.alert{
  font-size:18px;
  font-weight:bold;
  color:var(--red);
}

</style>
</head>

<body>

<header>
  <h1>CDC FUTURO-PRO üî• SHORT MODE</h1>
</header>

<div id="statusBar">Inicializando scanner...</div>

<div class="container">

  <div class="sidebar">
    <table>
      <thead>
        <tr>
          <th>MONEDA</th>
          <th>24H%</th>
          <th>48H%</th>
          <th>FALTA%</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>

  <div class="main">
    <div id="details" class="card">
      Selecciona una moneda para ver detalles SHORT.
    </div>
  </div>

</div>

<script>

const statusBar = document.getElementById("statusBar");

async function loadPRO(){

  statusBar.innerText = "Escaneando mercado SHORT...";

  try{

    const allTickers = await fetch("https://api.binance.com/api/v3/ticker/24hr")
      .then(r=>r.json());

    // Filtramos solo USDT y descartamos pares con BTC, BUSD u otras monedas
    const filtered = allTickers
      .filter(t => 
        t.symbol.endsWith("USDT") &&
        !t.symbol.includes("BTC") &&
        !t.symbol.includes("BUSD") &&
        parseFloat(t.priceChangePercent) > 8
      )
      .sort((a,b)=>parseFloat(b.priceChangePercent)-parseFloat(a.priceChangePercent))
      .slice(0,15);

    const tableBody = document.getElementById("tableBody");
    tableBody.innerHTML="";

    for(const t of filtered){

      const price = parseFloat(t.lastPrice);
      const high = parseFloat(t.highPrice);
      const low = parseFloat(t.lowPrice);

      const faltante = ((high - price) / (high - low)) * 100;

      const klines = await fetch(
        `https://api.binance.com/api/v3/klines?symbol=${t.symbol}&interval=1h&limit=48`
      ).then(r=>r.json());

      const open48 = parseFloat(klines[0][1]);
      const close48 = parseFloat(klines[47][4]);
      const change48 = ((close48 - open48) / open48) * 100;

      const tr=document.createElement("tr");

      tr.innerHTML=`
        <td><b>${t.symbol.replace("USDT","")}</b></td>
        <td style="color:#00c853">${parseFloat(t.priceChangePercent).toFixed(1)}%</td>
        <td style="color:#ff9800">${change48.toFixed(1)}%</td>
        <td style="color:${faltante<5?'#ff5252':'white'}">
          ${faltante.toFixed(1)}%
        </td>
      `;

      tr.onclick=()=>{
        showDetails(t, change48, faltante);
      };

      tableBody.appendChild(tr);
    }

    statusBar.innerText = "Actualizado correctamente ‚úÖ";

  }catch(e){
    statusBar.innerText = "Error con Binance ‚ö†Ô∏è";
  }
}

function showDetails(t, change48, faltante){

  const price = parseFloat(t.lastPrice);
  const high = parseFloat(t.highPrice);
  const low = parseFloat(t.lowPrice);

  let alerta = "";

  if(faltante < 5){
    alerta = `<p class="alert">üî• ZONA IDEAL SHORT üî•</p>`;
  }

  document.getElementById("details").innerHTML=`
    <h2 style="color:#fcd535">${t.symbol}</h2>

    <p><b>Precio actual:</b> $${price}</p>

    <p style="color:#00c853">
      <b>Subida 24H:</b> ${parseFloat(t.priceChangePercent).toFixed(2)}%
    </p>

    <p style="color:#00c853">
      <b>Subida 48H:</b> ${change48.toFixed(2)}%
    </p>

    <p><b>M√≠nimo 24H:</b> $${low}</p>
    <p><b>M√°ximo 24H (100%):</b> $${high}</p>

    <p style="color:#ff5252; font-size:16px;">
      Falta ${faltante.toFixed(2)}% para tocar el m√°ximo
    </p>

    ${alerta}
  `;
}

loadPRO();
setInterval(loadPRO,60000);

</script>

</body>
</html>
